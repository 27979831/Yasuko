function loadJS(e,o,t){var a=!!window.ActiveXObject,n=a&&!window.XMLHttpRequest,i=document.createElement("script"),l=n?document.documentElement:document.getElementsByTagName("head")[0];i.type="text/javascript",i.async=!0,i.readyState?i.onreadystatechange=function(){("loaded"==i.readyState||"complete"==i.readyState)&&(i.onreadystatechange=null,o&&o())}:i.onload=function(){o&&o()},i.src=e,t?document.getElementById(t).appendChild(i):l.insertBefore(i,l.firstChild)}$.fn.extend({isOnScreenVisible:function(){if(!$("body").hasClass("post-template"))return!1;var e=$(window),o={top:e.scrollTop(),left:e.scrollLeft()};o.right=o.left+e.width(),o.bottom=o.top+e.height();var t=this.offset();return t.right=t.left+this.outerWidth(),t.bottom=t.top+this.outerHeight(),!(o.right<t.left||o.left>t.right||o.bottom<t.top||o.top>t.bottom)}});var General={isMobile:!1,isWechat:!1,viewWidth:$(window).width(),init:function(){var e=window;e.document,navigator.userAgent.toLowerCase(),e.navigator.appVersion.match(/android/gi),e.navigator.appVersion.match(/iphone/gi);$("body").hasClass("post-template")&&General.updateImageWidth(),General.webFontLoader(),General.scrollToPos(),General.arrowEvent(),General.commentLoader()},updateImageWidth:function(){function e(){var e=$(this),o=t.outerWidth(),a=this.naturalWidth;a>=o?e.addClass("full-img"):e.removeClass("full-img")}function o(){a.each(e)}var t=$(".post-content"),a=$(".single-post-inner img").on("load",e);o()},webFontLoader:function(){console.log("加载字体"),WebFontConfig={custom:{families:["Exo"],urls:["../css/font.min.css"]}},WebFont.load({custom:{families:["Exo"]}})},arrowEvent:function(){$(".arrow_down").click(function(){return $("html,body").animate({scrollTop:$(window).height()-20},600,function(){window.location.hash="#"}),!1})},scrollToPos:function(e){var o="我要飞到最高",t=(e||$(window).height(),$('<a href="#" id="to-top" title="'+o+'"> <div class="to-top-wrap"></div></a>').appendTo("body"));$(window).scroll(function(){console.log("滚动2"),$(window).scrollTop()>$(window).height()?t.fadeIn(500):t.fadeOut(500)}),t.click(function(e){e.preventDefault(),$("html,body").animate({scrollTop:0},666,function(){window.location.hash="#"}),console.log("我跳")})},urlIconlize:function(e){var o,t,a="iconfont",n={twitter:a+"-twitter",qzone:a+"-qzone",weibo:a+"-weibo",facebook:a+"-facebook",github:a+"-github",douban:a+"-douban",google:a+"-google",luolei:a+"-luolei",dribble:a+"-dribble"};for(var i in n)if("function"!=typeof n[i]){var l=i;e.indexOf(l)>=0&&(o=l,t=n[l])}return t},addIcons:function(){$(".single-post-inner  a:not(:has(img))").each(function(e){var o=$(this).attr("href"),t=document.createElement("a");t.href=o,_selfDomain=t.hostname,General.urlIconlize(_selfDomain),console.log(_selfDomain),$(this).prepend('<i class="iconfont '+General.urlIconlize(_selfDomain)+'"></i>');var a=$(this).find("i").css("color"),n=$(this).css("color");$(this).hover(function(){$(this).css("color",a),$(this).addClass("animated pulse")},function(){$(this).css("color",n),$(this).removeClass("animated pulse")})})},commentLoader:function(){var e=location.protocol+"//"+location.host+location.pathname;$(window).scroll(function(){return $(".comment-area").has("div").length>0?(console.log("已经有了"),!1):(console.log("增加评论"),void($(".author-image").isOnScreenVisible()&&0==$(".author-image").hasClass("duoshuo-loaded")&&($(".author-image").addClass("duoshuo-loaded"),loadJS("https://static.duoshuo.com/embed.js",function(){var o=document.createElement("div");o.setAttribute("data-thread-key",e),o.setAttribute("data-url",location.href),o.setAttribute("data-title",$("title").html()),DUOSHUO.EmbedThread(o),scrollStop=!0,console.log("停止标记"),setTimeout(function(){$(".comment-area").append(o)},250)}))))})}},ImageSmartLoader={isWebPSupported:!1,isImageCompressed:!1,init:function(){ImageSmartLoader.webPCheck()},isCompressedCheck:function(){},webPCheck:function(e,o){var t={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"},a=new Image;a.onload=function(){a.width>0&&a.height>0;console.log("支持Webp"),ImageSmartLoader.isWebPSupported=!0,ImageSmartLoader.webPLoader()},a.onerror=function(){console.log("不支持Webp"),ImageSmartLoader.isWebPSupported=!1,ImageSmartLoader.webPLoader()},a.src="data:image/webp;base64,"+t.lossy},imgLoader:function(){console.log("加载默认图片")},webPLoader:function(){console.log("加载webP"),1==ImageSmartLoader.isWebPSupported?General.viewWidth<=1024?$(".lazy").lazyload({advanced_load:!0,data_attribute:"url",webP_load:!0,is_scale:!0,scale_width:750}):$(".lazy").lazyload({advanced_load:!0,data_attribute:"url",webP_load:!0,is_scale:!1}):General.viewWidth<=1024?$(".lazy").lazyload({advanced_load:!0,data_attribute:"url",webP_load:!1,is_scale:!0,scale_width:750}):$(".lazy").lazyload({advanced_load:!0,data_attribute:"url",webP_load:!1,is_scale:!1})}};$(document).ready(function(){General.init(),ImageSmartLoader.init(),$("body").hasClass("post-template")&&(General.addIcons(),General.commentLoader())});